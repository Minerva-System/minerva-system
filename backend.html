<!DOCTYPE HTML>
<html lang="pt-br" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Back-End - Minerva System</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html"><strong aria-hidden="true">1.</strong> Introdução</a></li><li class="chapter-item expanded "><a href="estrutura.html"><strong aria-hidden="true">2.</strong> Estrutura geral do projeto</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">2.1.</strong> Front-End</div></li><li class="chapter-item expanded "><a href="backend.html" class="active"><strong aria-hidden="true">2.2.</strong> Back-End</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Regras de Negócio</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="documentacao.html"><strong aria-hidden="true">3.1.</strong> Documentação do Projeto</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Cache de Sessão via Redis</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.</strong> Diagramas</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="diagramas/casos-de-uso.html"><strong aria-hidden="true">3.3.1.</strong> Diagramas de Caso de Uso</a></li><li class="chapter-item expanded "><a href="diagramas-sequencia.html"><strong aria-hidden="true">3.3.2.</strong> Diagramas de Sequência</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.1.</strong> Inquilinos (TENANCY)</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.1.1.</strong> Listagem de nomes de inquilinos</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.1.2.</strong> Listagem de inquilinos</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.1.3.</strong> Criar inquilino</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.1.4.</strong> Desativar inquilino</div></li></ol></li><li class="chapter-item expanded "><a href="diagramas-sequencia-sessao.html"><strong aria-hidden="true">3.3.2.2.</strong> Sessão (SESSION)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="diagramas/login.html"><strong aria-hidden="true">3.3.2.2.1.</strong> Login do usuário</a></li><li class="chapter-item expanded "><a href="diagramas/logoff.html"><strong aria-hidden="true">3.3.2.2.2.</strong> Logoff do usuário</a></li></ol></li><li class="chapter-item expanded "><a href="diagramas-sequencia-usuarios.html"><strong aria-hidden="true">3.3.2.3.</strong> Usuários (USER)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="diagramas/cadastro-usuarios.html"><strong aria-hidden="true">3.3.2.3.1.</strong> Cadastro de usuários</a></li><li class="chapter-item expanded "><a href="diagramas/lista-usuarios.html"><strong aria-hidden="true">3.3.2.3.2.</strong> Listagem de usuários</a></li><li class="chapter-item expanded "><a href="diagramas/consultar-usuarios.html"><strong aria-hidden="true">3.3.2.3.3.</strong> Consultar usuário</a></li><li class="chapter-item expanded "><a href="diagramas/alteracao-usuarios.html"><strong aria-hidden="true">3.3.2.3.4.</strong> Alteração de cadastro de usuários</a></li><li class="chapter-item expanded "><a href="diagramas/remocao-usuarios.html"><strong aria-hidden="true">3.3.2.3.5.</strong> Remoção de usuários</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.4.</strong> Produtos (PRODUCT)</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.4.1.</strong> Cadastro de produtos</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.4.2.</strong> Listagem de produtos</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.4.3.</strong> Consultar produto</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.4.4.</strong> Alteração de cadastro de produtos</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.4.5.</strong> Remoção de produtos</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.5.</strong> Estoque (STOCK)</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.5.1.</strong> Início de estoque</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.5.2.</strong> Consulta de estoque</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.5.3.</strong> Listagem de estoques</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.5.4.</strong> Entrada de estoque</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.5.5.</strong> Saída de estoque</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.5.6.</strong> Listagem de movimentações de um estoque</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.6.</strong> Relatórios (REPORT)</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.6.1.</strong> Listagem de Entidades na tela</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.6.2.</strong> Listagem de Entidades em PDF</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.7.</strong> Clientes (CLIENT)</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.7.1.</strong> Cadastro de clientes</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.7.2.</strong> Listagem de clientes</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.7.3.</strong> Consultar cliente</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.7.4.</strong> Alteração de cadastro de cliente</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.7.5.</strong> Remoção de clientes</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.8.</strong> Auditoria (AUDIT)</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.8.1.</strong> Consultar logs de auditoria</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.9.</strong> Comunicação Instantânea (COMM)</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.9.1.</strong> Enviar mensagem via WhatsApp</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.9.2.</strong> Enviar mensagem via Facebook Messenger</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.9.3.</strong> Enviar mensagem via Instagram</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.9.4.</strong> Enviar mensagem via Telegram</div></li></ol></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="multi-tenancy.html"><strong aria-hidden="true">4.</strong> Multi-Tenancy</a></li><li class="chapter-item expanded "><a href="banco-relacional.html"><strong aria-hidden="true">5.</strong> Banco de Dados Relacional</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="migrations.html"><strong aria-hidden="true">5.1.</strong> Executando migrations</a></li></ol></li><li class="chapter-item expanded "><a href="banco-nao-relacional.html"><strong aria-hidden="true">6.</strong> Banco de Dados Não-Relacional</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="colecoes.html"><strong aria-hidden="true">6.1.</strong> Coleções</a></li></ol></li><li class="chapter-item expanded "><a href="compilacao.html"><strong aria-hidden="true">7.</strong> Compilação</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="executar-maquina.html"><strong aria-hidden="true">7.1.</strong> Executar com recursos da máquina</a></li><li class="chapter-item expanded "><a href="gerando-imagens.html"><strong aria-hidden="true">7.2.</strong> Gerando imagens via Docker</a></li></ol></li><li class="chapter-item expanded "><a href="deploy.html"><strong aria-hidden="true">8.</strong> Deploy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="deploy-compose.html"><strong aria-hidden="true">8.1.</strong> Deploy via Docker Compose</a></li><li class="chapter-item expanded "><a href="deploy-swarm.html"><strong aria-hidden="true">8.2.</strong> Deploy via Docker Swarm</a></li><li class="chapter-item expanded "><a href="deploy-kubernetes.html"><strong aria-hidden="true">8.3.</strong> Deploy via Kubernetes</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Minerva System</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="back-end"><a class="header" href="#back-end">Back-End</a></h1>
<p>O back-end Minerva compõe-se de microsserviços, com uma interface comum de
comunicação externa que seja simples de usar para os padrões atuais.</p>
<p>O back-end compõe-se dos seguintes componentes:</p>
<ol>
<li>Componente de comunicação externa: um serviço composto de rotas, sendo
portanto uma API REST. Este serviço requisita dados sob demanda a cada
serviço, dependendo do recurso que foi requisitado por via externa. É
efetivamente o intermediário entre Minerva e o mundo externo. As
requisições entre este serviço e os outros deverão ser feito através da
abertura de uma requisição gRPC em que este módulo seja o cliente
requisitante; as respostas recebidas via gRPC são então retornadas
como resposta às requisições recebidas via REST, após tratamento para
serialização como JSON.</li>
<li>Componente de usuários: Servidor gRPC responsável por realizar o CRUD
de usuários e por verificar as regras de negócio destas operações.</li>
<li>Componente de sessão: Servidor gRPC responsável por realizar login,
logoff, verificação de senha e gerenciamento de sessão de usuários.</li>
<li>Componente de produtos: Servidor gRPC responsável por realizar o CRUD
de produtos e por verificar as regras de negócio destas operações.</li>
<li>Componente de estoque: Servidor gRPC responsável por realizar regras
de negócios relacionadas a estoque de produtos (início, baixa, lançamento,
etc).</li>
</ol>
<p>Os <strong>serviços gRPC</strong> supracitados tratam-se de servidores gRPC que podem
receber conexões vindas do ponto de entrada REST ou mesmo entre si. Além
disso, os serviços gRPC devem ser capazes de se comunicar com bancos de
dados, que são recursos essenciais para os mesmos (exemplo: PostgreSQL,
Redis). Além disso, <strong>estes serviços devem gravar log de suas operações</strong>,
mais especificamente nas operações de inserção, atualização e exclusão.</p>
<p>Esses componentes possuem análogos programados, mas não são todos os módulos
da aplicação, que também constituem-se de bibliotecas que podem ser utilizadas
e referenciadas entre si.</p>
<style>
svg:not(:root ) {
      max-width: 100%;
	  height: auto;
}
</style>
<center>
<div><!-- Generated by graphviz version 2.43.0 (0)
 --><!-- Title: %3 Pages: 1 --><svg width="707pt" height="377pt"
 viewBox="0.00 0.00 707.00 377.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 373)"><title>%3</title><g id="clust1" class="cluster"><title>cluster_db</title><polygon fill="transparent" stroke="darkmagenta" points="343,-8 343,-98 557,-98 557,-8 343,-8"/><text text-anchor="middle" x="450" y="-82.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">BANCO DE DADOS</text><text text-anchor="middle" x="450" y="-67.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">(multi&#45;tenant)</text></g><g id="clust3" class="cluster"><title>cluster_backend</title><polygon fill="transparent" stroke="darkred" points="8,-106 8,-325 691,-325 691,-106 8,-106"/><text text-anchor="middle" x="349.5" y="-309.8" font-family="Times,serif" font-size="14.00" fill="darkred">BACK&#45;END</text></g><!-- frontend --><g id="node1" class="node"><title>frontend</title><polygon fill="transparent" stroke="darkorange" points="393,-369 293,-369 293,-333 399,-333 399,-363 393,-369"/><polyline fill="none" stroke="darkorange" points="393,-369 393,-363 "/><polyline fill="none" stroke="darkorange" points="399,-363 393,-363 "/><text text-anchor="middle" x="346" y="-347.3" font-family="Times,serif" font-size="14.00" fill="darkorange">FRONT&#45;END</text></g><!-- rest --><g id="node5" class="node"><title>rest</title><polygon fill="#999999" stroke="green" points="374,-294 322,-294 318,-290 318,-258 370,-258 374,-262 374,-294"/><polyline fill="none" stroke="green" points="370,-290 318,-290 "/><polyline fill="none" stroke="green" points="370,-290 370,-258 "/><polyline fill="none" stroke="green" points="370,-290 374,-294 "/><text text-anchor="middle" x="346" y="-272.3" font-family="Times,serif" font-size="14.00" fill="green">REST</text></g><!-- frontend&#45;&#45;rest --><g id="edge20" class="edge"><title>frontend&#45;&#45;rest</title><path fill="none" stroke="green" stroke-width="2" d="M346,-332.7C346,-321.06 346,-305.79 346,-294.18"/></g><!-- db2 --><g id="node2" class="node"><title>db2</title><path fill="#999999" stroke="darkmagenta" d="M549,-48.73C549,-50.53 536.9,-52 522,-52 507.1,-52 495,-50.53 495,-48.73 495,-48.73 495,-19.27 495,-19.27 495,-17.47 507.1,-16 522,-16 536.9,-16 549,-17.47 549,-19.27 549,-19.27 549,-48.73 549,-48.73"/><path fill="none" stroke="darkmagenta" d="M549,-48.73C549,-46.92 536.9,-45.45 522,-45.45 507.1,-45.45 495,-46.92 495,-48.73"/><text text-anchor="middle" x="522" y="-30.3" font-family="Times,serif" font-size="14.00" fill="darkmagenta">inq3</text></g><!-- db1 --><g id="node3" class="node"><title>db1</title><path fill="#999999" stroke="darkmagenta" d="M477,-48.73C477,-50.53 464.9,-52 450,-52 435.1,-52 423,-50.53 423,-48.73 423,-48.73 423,-19.27 423,-19.27 423,-17.47 435.1,-16 450,-16 464.9,-16 477,-17.47 477,-19.27 477,-19.27 477,-48.73 477,-48.73"/><path fill="none" stroke="darkmagenta" d="M477,-48.73C477,-46.92 464.9,-45.45 450,-45.45 435.1,-45.45 423,-46.92 423,-48.73"/><text text-anchor="middle" x="450" y="-30.3" font-family="Times,serif" font-size="14.00" fill="darkmagenta">inq2</text></g><!-- db3 --><g id="node4" class="node"><title>db3</title><path fill="#999999" stroke="darkmagenta" d="M405,-48.73C405,-50.53 392.9,-52 378,-52 363.1,-52 351,-50.53 351,-48.73 351,-48.73 351,-19.27 351,-19.27 351,-17.47 363.1,-16 378,-16 392.9,-16 405,-17.47 405,-19.27 405,-19.27 405,-48.73 405,-48.73"/><path fill="none" stroke="darkmagenta" d="M405,-48.73C405,-46.92 392.9,-45.45 378,-45.45 363.1,-45.45 351,-46.92 351,-48.73"/><text text-anchor="middle" x="378" y="-30.3" font-family="Times,serif" font-size="14.00" fill="darkmagenta">inq1</text></g><!-- tenancy --><g id="node6" class="node"><title>tenancy</title><polygon fill="#999999" stroke="blue" points="288.5,-222 203.5,-222 199.5,-218 199.5,-186 284.5,-186 288.5,-190 288.5,-222"/><polyline fill="none" stroke="blue" points="284.5,-218 199.5,-218 "/><polyline fill="none" stroke="blue" points="284.5,-218 284.5,-186 "/><polyline fill="none" stroke="blue" points="284.5,-218 288.5,-222 "/><text text-anchor="middle" x="244" y="-200.3" font-family="Times,serif" font-size="14.00" fill="blue">TENANCY</text></g><!-- rest&#45;&#45;tenancy --><g id="edge3" class="edge"><title>rest&#45;&#45;tenancy</title><path fill="none" stroke="blue" stroke-width="2" d="M321.05,-257.88C305.24,-247.03 284.87,-233.05 269.05,-222.19"/></g><!-- user --><g id="node7" class="node"><title>user</title><polygon fill="#999999" stroke="blue" points="181.5,-222 126.5,-222 122.5,-218 122.5,-186 177.5,-186 181.5,-190 181.5,-222"/><polyline fill="none" stroke="blue" points="177.5,-218 122.5,-218 "/><polyline fill="none" stroke="blue" points="177.5,-218 177.5,-186 "/><polyline fill="none" stroke="blue" points="177.5,-218 181.5,-222 "/><text text-anchor="middle" x="152" y="-200.3" font-family="Times,serif" font-size="14.00" fill="blue">USER</text></g><!-- rest&#45;&#45;user --><g id="edge4" class="edge"><title>rest&#45;&#45;user</title><path fill="none" stroke="blue" stroke-width="2" d="M317.75,-266.11C286.49,-256.09 234.74,-238.98 191,-222 187.97,-220.82 184.83,-219.55 181.71,-218.25"/></g><!-- session --><g id="node8" class="node"><title>session</title><polygon fill="#999999" stroke="blue" points="365,-150 285,-150 281,-146 281,-114 361,-114 365,-118 365,-150"/><polyline fill="none" stroke="blue" points="361,-146 281,-146 "/><polyline fill="none" stroke="blue" points="361,-146 361,-114 "/><polyline fill="none" stroke="blue" points="361,-146 365,-150 "/><text text-anchor="middle" x="323" y="-128.3" font-family="Times,serif" font-size="14.00" fill="blue">SESSION</text></g><!-- rest&#45;&#45;session --><g id="edge5" class="edge"><title>rest&#45;&#45;session</title><path fill="none" stroke="blue" stroke-width="2" d="M367.71,-257.79C377.76,-248.41 388.64,-235.9 394,-222 399.76,-207.07 401.17,-200.3 394,-186 386.35,-170.74 371.98,-158.75 358.17,-150.06"/></g><!-- product --><g id="node9" class="node"><title>product</title><polygon fill="#999999" stroke="blue" points="514.5,-222 427.5,-222 423.5,-218 423.5,-186 510.5,-186 514.5,-190 514.5,-222"/><polyline fill="none" stroke="blue" points="510.5,-218 423.5,-218 "/><polyline fill="none" stroke="blue" points="510.5,-218 510.5,-186 "/><polyline fill="none" stroke="blue" points="510.5,-218 514.5,-222 "/><text text-anchor="middle" x="469" y="-200.3" font-family="Times,serif" font-size="14.00" fill="blue">PRODUCT</text></g><!-- rest&#45;&#45;product --><g id="edge6" class="edge"><title>rest&#45;&#45;product</title><path fill="none" stroke="blue" stroke-width="2" d="M374.22,-258.94C393.51,-247.96 419.05,-233.42 438.76,-222.21"/></g><!-- stock --><g id="node10" class="node"><title>stock</title><polygon fill="#999999" stroke="blue" points="601,-222 537,-222 533,-218 533,-186 597,-186 601,-190 601,-222"/><polyline fill="none" stroke="blue" points="597,-218 533,-218 "/><polyline fill="none" stroke="blue" points="597,-218 597,-186 "/><polyline fill="none" stroke="blue" points="597,-218 601,-222 "/><text text-anchor="middle" x="567" y="-200.3" font-family="Times,serif" font-size="14.00" fill="blue">STOCK</text></g><!-- rest&#45;&#45;stock --><g id="edge7" class="edge"><title>rest&#45;&#45;stock</title><path fill="none" stroke="blue" stroke-width="2" d="M374.3,-267.4C409.61,-257.72 471.74,-240.07 524,-222 526.88,-221 529.86,-219.93 532.83,-218.82"/></g><!-- report --><g id="node12" class="node"><title>report</title><polygon fill="#999999" stroke="blue" points="385,-222 311,-222 307,-218 307,-186 381,-186 385,-190 385,-222"/><polyline fill="none" stroke="blue" points="381,-218 307,-218 "/><polyline fill="none" stroke="blue" points="381,-218 381,-186 "/><polyline fill="none" stroke="blue" points="381,-218 385,-222 "/><text text-anchor="middle" x="346" y="-200.3" font-family="Times,serif" font-size="14.00" fill="blue">REPORT</text></g><!-- rest&#45;&#45;report --><g id="edge11" class="edge"><title>rest&#45;&#45;report</title><path fill="none" stroke="blue" stroke-width="2" d="M346,-257.7C346,-246.85 346,-232.92 346,-222.1"/></g><!-- client --><g id="node13" class="node"><title>client</title><polygon fill="#999999" stroke="blue" points="139.5,-150 70.5,-150 66.5,-146 66.5,-114 135.5,-114 139.5,-118 139.5,-150"/><polyline fill="none" stroke="blue" points="135.5,-146 66.5,-146 "/><polyline fill="none" stroke="blue" points="135.5,-146 135.5,-114 "/><polyline fill="none" stroke="blue" points="135.5,-146 139.5,-150 "/><text text-anchor="middle" x="103" y="-128.3" font-family="Times,serif" font-size="14.00" fill="blue">CLIENT</text></g><!-- rest&#45;&#45;client --><g id="edge8" class="edge"><title>rest&#45;&#45;client</title><path fill="none" stroke="blue" stroke-width="2" d="M317.64,-272.58C261.66,-267.2 140.03,-252.23 113,-222 95.49,-202.41 96.74,-169.9 99.61,-150.06"/></g><!-- audit --><g id="node14" class="node"><title>audit</title><polygon fill="#999999" stroke="blue" points="683,-222 623,-222 619,-218 619,-186 679,-186 683,-190 683,-222"/><polyline fill="none" stroke="blue" points="679,-218 619,-218 "/><polyline fill="none" stroke="blue" points="679,-218 679,-186 "/><polyline fill="none" stroke="blue" points="679,-218 683,-222 "/><text text-anchor="middle" x="651" y="-200.3" font-family="Times,serif" font-size="14.00" fill="blue">AUDIT</text></g><!-- rest&#45;&#45;audit --><g id="edge9" class="edge"><title>rest&#45;&#45;audit</title><path fill="none" stroke="blue" stroke-width="2" d="M374.19,-271.19C422.96,-264.18 525.93,-247.6 610,-222 612.95,-221.1 615.98,-220.07 618.99,-218.97"/></g><!-- comm --><g id="node15" class="node"><title>comm</title><polygon fill="#999999" stroke="blue" points="83.5,-222 20.5,-222 16.5,-218 16.5,-186 79.5,-186 83.5,-190 83.5,-222"/><polyline fill="none" stroke="blue" points="79.5,-218 16.5,-218 "/><polyline fill="none" stroke="blue" points="79.5,-218 79.5,-186 "/><polyline fill="none" stroke="blue" points="79.5,-218 83.5,-222 "/><text text-anchor="middle" x="50" y="-200.3" font-family="Times,serif" font-size="14.00" fill="blue">COMM</text></g><!-- rest&#45;&#45;comm --><g id="edge10" class="edge"><title>rest&#45;&#45;comm</title><path fill="none" stroke="blue" stroke-width="2" d="M317.82,-270.21C271.5,-262.06 176.59,-244.21 98,-222 93.32,-220.68 88.44,-219.14 83.65,-217.54"/></g><!-- tenancy&#45;&#45;db1 --><g id="edge12" class="edge"><title>tenancy&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" stroke-width="2" d="M288.57,-188.76C336.44,-173.43 405.87,-151.08 407,-150 421.53,-136.09 431.19,-116.8 437.6,-98"/></g><!-- user&#45;&#45;db1 --><g id="edge13" class="edge"><title>user&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" stroke-width="2" d="M181.56,-189.33C184.71,-188.11 187.9,-186.97 191,-186 270.12,-161.29 303.8,-194.09 374,-150 394.7,-137 391.61,-124.99 407,-106 409.98,-102.33 411.26,-101.85 414,-98"/></g><!-- user&#45;&#45;session --><g id="edge1" class="edge"><title>user&#45;&#45;session</title><path fill="none" stroke="blue" stroke-width="2" d="M181.77,-189.92C184.88,-188.58 188,-187.25 191,-186 220.96,-173.46 254.97,-159.82 280.96,-149.52"/></g><!-- session&#45;&#45;db1 --><g id="edge14" class="edge"><title>session&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" stroke-width="2" d="M358.44,-113.94C365.17,-111.05 372.23,-108.26 379,-106 394.14,-100.95 401.18,-107.51 414,-98"/></g><!-- product&#45;&#45;db1 --><g id="edge15" class="edge"><title>product&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" stroke-width="2" d="M467.07,-185.97C464.75,-165.38 460.7,-129.58 457.12,-98"/></g><!-- stock&#45;&#45;db1 --><g id="edge16" class="edge"><title>stock&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" stroke-width="2" d="M552.47,-185.72C535.64,-165.34 507.46,-130.18 486,-98"/></g><!-- runonce --><g id="node11" class="node"><title>runonce</title><polygon fill="#999999" stroke="lightblue" points="682.5,-294 587.5,-294 587.5,-258 682.5,-258 682.5,-294"/><text text-anchor="middle" x="635" y="-272.3" font-family="Times,serif" font-size="14.00" fill="blue">RUNONCE</text></g><!-- runonce&#45;&#45;db1 --><g id="edge17" class="edge"><title>runonce&#45;&#45;db1</title><path fill="none" stroke="magenta" stroke-width="2" d="M661.58,-257.91C673.24,-248.81 685.69,-236.49 692,-222 698.39,-207.33 699.66,-200.05 692,-186 660.62,-128.41 629.94,-127.57 568,-106 550.71,-99.98 501.37,-107.95 486,-98"/></g><!-- client&#45;&#45;db1 --><g id="edge18" class="edge"><title>client&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" stroke-width="2" d="M139.8,-124.57C173.96,-118.84 226.26,-110.66 272,-106 287.72,-104.4 400.56,-106.31 414,-98"/></g><!-- audit&#45;&#45;db1 --><g id="edge19" class="edge"><title>audit&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" stroke-width="2" d="M633.22,-185.85C609.55,-163.98 565.48,-126.55 521,-106 506.52,-99.31 498.82,-107.51 486,-98"/></g><!-- comm&#45;&#45;client --><g id="edge2" class="edge"><title>comm&#45;&#45;client</title><path fill="none" stroke="blue" stroke-width="2" d="M63.1,-185.7C71.32,-174.85 81.86,-160.92 90.05,-150.1"/></g></g></svg></div>
</center>
<div><!-- Generated by graphviz version 2.43.0 (0)
 --><!-- Title: %3 Pages: 1 --><svg width="316pt" height="147pt"
 viewBox="0.00 0.00 316.00 147.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 143)"><title>%3</title><g id="clust1" class="cluster"><title>cluster_legenda</title><polygon fill="white" stroke="black" points="8,-8 8,-131 300,-131 300,-8 8,-8"/><text text-anchor="middle" x="154" y="-115.8" font-family="Times,serif" font-size="14.00">Legenda: Tipos de Conexão</text></g><!-- key --><g id="node1" class="node"><title>key</title><polygon fill="transparent" stroke="transparent" points="220,-100 16,-100 16,-16 220,-16 220,-100"/><text text-anchor="start" x="161" y="-82.8" font-family="Times,serif" font-size="14.00">gRPC &#160;</text><text text-anchor="start" x="26" y="-63.8" font-family="Times,serif" font-size="14.00">Banco de Dados via Pool &#160;</text><text text-anchor="start" x="35" y="-44.8" font-family="Times,serif" font-size="14.00">Banco de Dados Avulsa &#160;</text><text text-anchor="start" x="90" y="-25.8" font-family="Times,serif" font-size="14.00">HTTP via REST &#160;</text></g><!-- key2 --><g id="node2" class="node"><title>key2</title><polygon fill="transparent" stroke="transparent" points="292,-100 238,-100 238,-16 292,-16 292,-100"/><text text-anchor="start" x="263" y="-82.8" font-family="Times,serif" font-size="14.00"></text><text text-anchor="start" x="263" y="-63.8" font-family="Times,serif" font-size="14.00"></text><text text-anchor="start" x="263" y="-44.8" font-family="Times,serif" font-size="14.00"></text><text text-anchor="start" x="263" y="-25.8" font-family="Times,serif" font-size="14.00"></text></g><!-- key&#45;&#45;key2 --><g id="edge1" class="edge"><title>key:e&#45;&#45;key2:w</title><path fill="none" stroke="blue" stroke-width="2" d="M213,-87C233.89,-87 239.11,-87 260,-87"/></g><!-- key&#45;&#45;key2 --><g id="edge2" class="edge"><title>key:e&#45;&#45;key2:w</title><path fill="none" stroke="darkmagenta" stroke-width="2" d="M213,-68C233.89,-68 239.11,-68 260,-68"/></g><!-- key&#45;&#45;key2 --><g id="edge3" class="edge"><title>key:e&#45;&#45;key2:w</title><path fill="none" stroke="magenta" stroke-width="2" d="M213,-48C233.89,-48 239.11,-48 260,-48"/></g><!-- key&#45;&#45;key2 --><g id="edge4" class="edge"><title>key:e&#45;&#45;key2:w</title><path fill="none" stroke="green" stroke-width="2" d="M213,-29C233.89,-29 239.11,-29 260,-29"/></g></g></svg></div>
<h2 id="bibliotecas"><a class="header" href="#bibliotecas">Bibliotecas</a></h2>
<p>As bibliotecas planejadas para o sistema são:</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-rpc</code>: Implementação de protocolos gRPC e de mensagens destes
protocolo. Deve ser importado em todos os módulos, sendo essencial para
a criação de clientes e servidores gRPC. Os modelos de comunicação
implementados para si devem ser também convertidos para e
a partir dos DTOs do módulo de dados.</li>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-data</code>: Implementação de utilitários de comunicação com banco de
dados (PostgreSQL) e objetos de transferência de dados (DTOs). Deve ser
importado em todos os módulos, exceto na comunicação REST. Os DTOs também
devem implementar traits e utilitários para conversão das mensagens
implementadas em <code>minerva-rpc</code> para os DTOs desta biblioteca.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-cache</code>: Implementação de utilitários de comunicação com
cache, message brokers e armazenamento temporário <em>in-memory</em> (Redis).
Deve ser importado principalmente no módulo de sessão.</li>
</ul>
<h2 id="módulos"><a class="header" href="#módulos">Módulos</a></h2>
<p>Os módulos planejados para o sistema são:</p>
<ul>
<li><input disabled="" type="checkbox"/>
<code>minerva-tenancy</code>: Servidor gRPC para CRUD de inquilinos. Deve ser
capaz de gerenciar inquilinos, mas um inquilino não pode ser deletado
através desse serviço, apenas desativado. Apenas administradores do sistema
podem ter acesso.</li>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-user</code>: Servidor gRPC para CRUD de usuários. Deve ser capaz de
manipular as regras de negócios relacionadas a clientes.</li>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-session</code>: Servidor gRPC para gerência de sessão de usuário.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-product</code>: Servidor gRPC para CRUD de produtos. Deve ser capaz
de manipular as regras de negócios relacionadas a produtos, mas que não
envolvam controle de estoque.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-stock</code>: Servidor gRPC para CRUD de estoque de produtos. Deve
ser capaz de manipular as regras de negócios relacionadas a estoque, mas
que não envolvam manipulação de produtos.</li>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-rest</code>: Servidor REST para comunicação com os demais módulos
executáveis. Possui rotas que apontam para serviços específicos, e é por
definição um cliente gRPC de todos os servidores gRPC.</li>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-runonce</code>: Serviço <strong>avulso</strong> para configuração do ambiente, de
forma assíncrona. Responsável pela execução de migrações do banco de dados
e outras operações de configuração inicial.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-report</code>: Servidor gRPC para geração de relatórios. Deve receber
dados com formatação esperada de um relatório, e então deverá gerar um
arquivo PDF e retorná-lo inteiramente como resposta.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-client</code>: Servidor gRPC para CRUD de clientes. Deve ser capaz
de manipular as regras de negócios relacionadas a clientes.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-audit</code>: Servidor gRPC para gerenciamento de logs de auditoria.
Possibilita a consulta aos logs de auditoria do sistema.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-comm</code>: Servidor gRPC para comunicação externa com clientes
via mensagens instantâneas.</li>
</ul>
<h2 id="portas"><a class="header" href="#portas">Portas</a></h2>
<p>Os serviços, independente de serem gRPC ou REST, devem ser executados em
certas portas padrão para evitarem conflitos durante o tempo de depuração.
Cada porta deve também ser configurável através de variáveis de ambiente.</p>
<p>A tabela a seguir discrimina as variáveis de ambiente e as portas padrão
de acordo com o serviço em questão.</p>
<table><thead><tr><th>Serviço</th><th>Variável</th><th>Valor</th></tr></thead><tbody>
<tr><td>REST</td><td><code>ROCKET_PORT</code></td><td>9000</td></tr>
<tr><td>USER</td><td><code>USER_SERVICE_PORT</code></td><td>9010</td></tr>
<tr><td>SESSION</td><td><code>SESSION_SERVICE_PORT</code></td><td>9011</td></tr>
<tr><td>PRODUCT</td><td><code>PRODUCT_SERVICE_PORT</code></td><td>9012</td></tr>
<tr><td>STOCK</td><td><code>STOCK_SERVICE_PORT</code></td><td>9013</td></tr>
<tr><td>REPORT</td><td><code>REPORT_SERVICE_PORT</code></td><td>9014</td></tr>
<tr><td>TENANCY</td><td><code>TENANCY_SERVICE_PORT</code></td><td>9015</td></tr>
<tr><td>CLIENT</td><td><code>CLIENT_SERVICE_PORT</code></td><td>9016</td></tr>
<tr><td>AUDIT</td><td><code>AUDIT_SERVICE_PORT</code></td><td>9017</td></tr>
<tr><td>COMM</td><td><code>COMM_SERVICE_PORT</code></td><td>9018</td></tr>
</tbody></table>
<p>No caso do serviço REST, verifique o arquivo <code>Rocket.toml</code> para avaliar
a configuração em desenvolvimento e em produção do mesmo.</p>
<h2 id="gateways"><a class="header" href="#gateways">Gateways</a></h2>
<p>Os serviços também podem operar em máquinas diferentes, dependendo de sua
rota.</p>
<p>Normalmente, quando todos os serviços são executados manualmente na mesma
máquina, operamos com uma rota <code>localhost</code>. Nesse caso, a variável de
ambiente de cada serviço é definida como esse valor.</p>
<p>Todavia, num ambiente de orquestração de contêineres (como Docker Compose
ou Kubernetes), cada serviço estará operando de forma separada, e poderá
comunicar-se com os outros serviços por intermédio de uma rede interna
ao qual apenas os serviços têm acesso de forma explícita. Assim, as
variáveis de ambiente que determinam o nome do servidor devem ser definidas
manualmente, de acordo com a forma como o deploy de cada serviço foi
realizado.</p>
<p>A seguir, temos uma tabela relacionando variáveis de ambiente com seus
devidos valores, que serão resolvidos através do DNS da rede interna criada
pelo orquestrador de contêineres.</p>
<p>No caso do serviço REST, verifique o arquivo <code>Rocket.toml</code> para avaliar
a configuração em desenvolvimento e em produção do mesmo.</p>
<table><thead><tr><th>Serviço</th><th>Variável</th><th>Valor em Produção</th></tr></thead><tbody>
<tr><td>USER</td><td><code>USER_SERVICE_SERVER</code></td><td><code>users</code></td></tr>
<tr><td>Banco de Dados Relacional</td><td><code>DATABASE_SERVICE_SERVER</code></td><td><code>postgresql</code></td></tr>
<tr><td>Banco de Dados Não-Relacional</td><td><code>MONGO_SERVICE_SERVER</code></td><td><code>mongodb</code></td></tr>
<tr><td>REST</td><td>nenhuma</td><td><code>rest</code></td></tr>
<tr><td>RUNONCE</td><td>nenhuma</td><td><code>runonce</code></td></tr>
<tr><td>SESSION</td><td><code>SESSION_SERVICE_SERVER</code></td><td><code>session</code></td></tr>
</tbody></table>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="estrutura.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="documentacao.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="estrutura.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="documentacao.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
