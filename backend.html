<!DOCTYPE HTML>
<html lang="pt-br" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Back-End - Sistema Minerva</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html"><strong aria-hidden="true">1.</strong> Introdução</a></li><li class="chapter-item expanded "><a href="estrutura.html"><strong aria-hidden="true">2.</strong> Estrutura geral do projeto</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="backend.html" class="active"><strong aria-hidden="true">2.1.</strong> Back-End</a></li></ol></li><li class="chapter-item expanded "><a href="multi-tenancy.html"><strong aria-hidden="true">3.</strong> Multi-Tenancy</a></li><li class="chapter-item expanded "><a href="compilacao.html"><strong aria-hidden="true">4.</strong> Compilação</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="executar-maquina.html"><strong aria-hidden="true">4.1.</strong> Executar com recursos da máquina</a></li><li class="chapter-item expanded "><a href="deploy-compose.html"><strong aria-hidden="true">4.2.</strong> Deploy via Docker Compose</a></li><li class="chapter-item expanded "><a href="deploy-kubernetes.html"><strong aria-hidden="true">4.3.</strong> Deploy via Kubernetes</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Sistema Minerva</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="back-end"><a class="header" href="#back-end">Back-End</a></h1>
<p>O back-end Minerva compõe-se de microsserviços, com uma interface comum de
comunicação externa que seja simples de usar para os padrões atuais.</p>
<p>O back-end compõe-se dos seguintes componentes:</p>
<ol>
<li>Componente de comunicação externa: um serviço composto de rotas, sendo
portanto uma API REST. Este serviço requisita dados sob demanda a cada
serviço, dependendo do recurso que foi requisitado por via externa. É
efetivamente o intermediário entre Minerva e o mundo externo. As
requisições entre este serviço e os outros deverão ser feito através da
abertura de uma requisição gRPC em que este módulo seja o cliente
requisitante; as respostas recebidas via gRPC são então retornadas
como resposta às requisições recebidas via REST, após tratamento para
serialização como JSON.</li>
<li>Componente de usuários: Servidor gRPC responsável por realizar o CRUD
de usuários e por verificar as regras de negócio destas operações.</li>
<li>Componente de sessão: Servidor gRPC responsável por realizar login,
logoff, verificação de senha e gerenciamento de sessão de usuários.</li>
<li>Componente de produtos: Servidor gRPC responsável por realizar o CRUD
de produtos e por verificar as regras de negócio destas operações.</li>
<li>Componente de estoque: Servidor gRPC responsável por realizar regras
de negócios relacionadas a estoque de produtos (início, baixa, lançamento,
etc).</li>
</ol>
<p>Os <strong>serviços gRPC</strong> supracitados tratam-se de servidores gRPC que podem
receber conexões vindas do ponto de entrada REST ou mesmo entre si. Além
disso, os serviços gRPC devem ser capazes de se comunicar com bancos de
dados, que são recursos essenciais para os mesmos (exemplo: PostgreSQL,
Redis). Além disso, <strong>estes serviços devem gravar log de suas operações</strong>,
mais especificamente nas operações de inserção, atualização e exclusão.</p>
<p>Esses componentes possuem análogos programados, mas não são todos os módulos
da aplicação, que também constituem-se de bibliotecas que podem ser utilizadas
e referenciadas entre si.</p>
<div><!-- Generated by graphviz version 2.43.0 (0)
 --><!-- Title: %3 Pages: 1 --><svg width="590pt" height="393pt"
 viewBox="0.00 0.00 590.00 393.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 389)"><title>%3</title><polygon fill="white" stroke="transparent" points="-4,4 -4,-389 586,-389 586,4 -4,4"/><g id="clust1" class="cluster"><title>cluster_db</title><polygon fill="none" stroke="darkmagenta" points="174,-8 174,-98 388,-98 388,-8 174,-8"/><text text-anchor="middle" x="281" y="-82.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">BANCO DE DADOS</text><text text-anchor="middle" x="281" y="-67.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">(multi&#45;inquilino)</text></g><g id="clust3" class="cluster"><title>cluster_backend</title><polygon fill="none" stroke="darkred" points="8,-146 8,-308 574,-308 574,-146 8,-146"/><text text-anchor="middle" x="291" y="-292.8" font-family="Times,serif" font-size="14.00" fill="darkred">BACK&#45;END</text></g><!-- frontend --><g id="node1" class="node"><title>frontend</title><polygon fill="white" stroke="darkorange" points="275,-385 175,-385 175,-349 281,-349 281,-379 275,-385"/><polyline fill="none" stroke="darkorange" points="275,-385 275,-379 "/><polyline fill="none" stroke="darkorange" points="281,-379 275,-379 "/><text text-anchor="middle" x="228" y="-363.3" font-family="Times,serif" font-size="14.00" fill="darkorange">FRONT&#45;END</text></g><!-- rest --><g id="node5" class="node"><title>rest</title><polygon fill="white" stroke="black" points="256,-277 204,-277 200,-273 200,-241 252,-241 256,-245 256,-277"/><polyline fill="none" stroke="black" points="252,-273 200,-273 "/><polyline fill="none" stroke="black" points="252,-273 252,-241 "/><polyline fill="none" stroke="black" points="252,-273 256,-277 "/><text text-anchor="middle" x="228" y="-255.3" font-family="Times,serif" font-size="14.00">REST</text></g><!-- frontend&#45;&#45;rest --><g id="edge13" class="edge"><title>frontend&#45;&#45;rest</title><path fill="none" stroke="green" d="M228,-348.97C228,-329.31 228,-297.13 228,-277.34"/><text text-anchor="middle" x="248" y="-319.8" font-family="Times,serif" font-size="14.00" fill="green">REST</text></g><!-- db2 --><g id="node2" class="node"><title>db2</title><path fill="white" stroke="darkmagenta" d="M380,-48.73C380,-50.53 367.9,-52 353,-52 338.1,-52 326,-50.53 326,-48.73 326,-48.73 326,-19.27 326,-19.27 326,-17.47 338.1,-16 353,-16 367.9,-16 380,-17.47 380,-19.27 380,-19.27 380,-48.73 380,-48.73"/><path fill="none" stroke="darkmagenta" d="M380,-48.73C380,-46.92 367.9,-45.45 353,-45.45 338.1,-45.45 326,-46.92 326,-48.73"/><text text-anchor="middle" x="353" y="-30.3" font-family="Times,serif" font-size="14.00" fill="darkmagenta">inq3</text></g><!-- db1 --><g id="node3" class="node"><title>db1</title><path fill="white" stroke="darkmagenta" d="M308,-48.73C308,-50.53 295.9,-52 281,-52 266.1,-52 254,-50.53 254,-48.73 254,-48.73 254,-19.27 254,-19.27 254,-17.47 266.1,-16 281,-16 295.9,-16 308,-17.47 308,-19.27 308,-19.27 308,-48.73 308,-48.73"/><path fill="none" stroke="darkmagenta" d="M308,-48.73C308,-46.92 295.9,-45.45 281,-45.45 266.1,-45.45 254,-46.92 254,-48.73"/><text text-anchor="middle" x="281" y="-30.3" font-family="Times,serif" font-size="14.00" fill="darkmagenta">inq2</text></g><!-- db3 --><g id="node4" class="node"><title>db3</title><path fill="white" stroke="darkmagenta" d="M236,-48.73C236,-50.53 223.9,-52 209,-52 194.1,-52 182,-50.53 182,-48.73 182,-48.73 182,-19.27 182,-19.27 182,-17.47 194.1,-16 209,-16 223.9,-16 236,-17.47 236,-19.27 236,-19.27 236,-48.73 236,-48.73"/><path fill="none" stroke="darkmagenta" d="M236,-48.73C236,-46.92 223.9,-45.45 209,-45.45 194.1,-45.45 182,-46.92 182,-48.73"/><text text-anchor="middle" x="209" y="-30.3" font-family="Times,serif" font-size="14.00" fill="darkmagenta">inq1</text></g><!-- user --><g id="node6" class="node"><title>user</title><polygon fill="white" stroke="black" points="75.5,-190 20.5,-190 16.5,-186 16.5,-154 71.5,-154 75.5,-158 75.5,-190"/><polyline fill="none" stroke="black" points="71.5,-186 16.5,-186 "/><polyline fill="none" stroke="black" points="71.5,-186 71.5,-154 "/><polyline fill="none" stroke="black" points="71.5,-186 75.5,-190 "/><text text-anchor="middle" x="46" y="-168.3" font-family="Times,serif" font-size="14.00">USER</text></g><!-- rest&#45;&#45;user --><g id="edge1" class="edge"><title>rest&#45;&#45;user</title><path fill="none" stroke="blue" d="M199.96,-244.91C166.26,-229.16 109.96,-202.87 75.58,-186.82"/><text text-anchor="middle" x="167" y="-211.8" font-family="Times,serif" font-size="14.00" fill="blue">gRPC</text></g><!-- session --><g id="node7" class="node"><title>session</title><polygon fill="white" stroke="black" points="217,-190 137,-190 133,-186 133,-154 213,-154 217,-158 217,-190"/><polyline fill="none" stroke="black" points="213,-186 133,-186 "/><polyline fill="none" stroke="black" points="213,-186 213,-154 "/><polyline fill="none" stroke="black" points="213,-186 217,-190 "/><text text-anchor="middle" x="175" y="-168.3" font-family="Times,serif" font-size="14.00">SESSION</text></g><!-- rest&#45;&#45;session --><g id="edge2" class="edge"><title>rest&#45;&#45;session</title><path fill="none" stroke="blue" d="M217.27,-240.8C208.08,-226.05 194.9,-204.92 185.71,-190.18"/><text text-anchor="middle" x="224" y="-211.8" font-family="Times,serif" font-size="14.00" fill="blue">gRPC</text></g><!-- product --><g id="node8" class="node"><title>product</title><polygon fill="white" stroke="black" points="326.5,-190 239.5,-190 235.5,-186 235.5,-154 322.5,-154 326.5,-158 326.5,-190"/><polyline fill="none" stroke="black" points="322.5,-186 235.5,-186 "/><polyline fill="none" stroke="black" points="322.5,-186 322.5,-154 "/><polyline fill="none" stroke="black" points="322.5,-186 326.5,-190 "/><text text-anchor="middle" x="281" y="-168.3" font-family="Times,serif" font-size="14.00">PRODUCT</text></g><!-- rest&#45;&#45;product --><g id="edge3" class="edge"><title>rest&#45;&#45;product</title><path fill="none" stroke="blue" d="M238.73,-240.8C247.92,-226.05 261.1,-204.92 270.29,-190.18"/><text text-anchor="middle" x="277" y="-211.8" font-family="Times,serif" font-size="14.00" fill="blue">gRPC</text></g><!-- stock --><g id="node9" class="node"><title>stock</title><polygon fill="white" stroke="black" points="452,-190 388,-190 384,-186 384,-154 448,-154 452,-158 452,-190"/><polyline fill="none" stroke="black" points="448,-186 384,-186 "/><polyline fill="none" stroke="black" points="448,-186 448,-154 "/><polyline fill="none" stroke="black" points="448,-186 452,-190 "/><text text-anchor="middle" x="418" y="-168.3" font-family="Times,serif" font-size="14.00">STOCK</text></g><!-- rest&#45;&#45;stock --><g id="edge4" class="edge"><title>rest&#45;&#45;stock</title><path fill="none" stroke="blue" d="M256.04,-245.46C290,-230.26 347.19,-204.68 383.73,-188.33"/><text text-anchor="middle" x="354" y="-211.8" font-family="Times,serif" font-size="14.00" fill="blue">gRPC</text></g><!-- report --><g id="node11" class="node"><title>report</title><polygon fill="white" stroke="black" points="392,-277 318,-277 314,-273 314,-241 388,-241 392,-245 392,-277"/><polyline fill="none" stroke="black" points="388,-273 314,-273 "/><polyline fill="none" stroke="black" points="388,-273 388,-241 "/><polyline fill="none" stroke="black" points="388,-273 392,-277 "/><text text-anchor="middle" x="353" y="-255.3" font-family="Times,serif" font-size="14.00">REPORT</text></g><!-- rest&#45;&#45;report --><g id="edge7" class="edge"><title>rest&#45;&#45;report</title><path fill="none" stroke="blue" d="M256.05,-259C273.04,-259 294.96,-259 313.67,-259"/><text text-anchor="middle" x="285" y="-265.8" font-family="Times,serif" font-size="14.00" fill="blue">gRPC</text></g><!-- user&#45;&#45;db1 --><g id="edge8" class="edge"><title>user&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" d="M69.54,-153.92C92.08,-138.54 127.63,-116.76 162,-106 179.68,-100.46 229.44,-108.06 245,-98"/><text text-anchor="middle" x="182.5" y="-124.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">DB</text><text text-anchor="middle" x="182.5" y="-109.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">(Pool)</text></g><!-- user&#45;&#45;session --><g id="edge5" class="edge"><title>user&#45;&#45;session</title><path fill="none" stroke="blue" d="M75.6,-172C92.56,-172 114.12,-172 132.83,-172"/><text text-anchor="middle" x="104.25" y="-178.8" font-family="Times,serif" font-size="14.00" fill="blue">gRPC</text></g><!-- session&#45;&#45;db1 --><g id="edge9" class="edge"><title>session&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" d="M190.39,-153.76C202.49,-140.43 219.92,-121.65 236,-106 239.84,-102.27 241.63,-102.16 245,-98"/><text text-anchor="middle" x="256.5" y="-124.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">DB</text><text text-anchor="middle" x="256.5" y="-109.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">(Pool)</text></g><!-- product&#45;&#45;db1 --><g id="edge10" class="edge"><title>product&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" d="M281,-153.78C281,-139.56 281,-118.48 281,-98"/><text text-anchor="middle" x="301.5" y="-124.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">DB</text><text text-anchor="middle" x="301.5" y="-109.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">(Pool)</text></g><!-- product&#45;&#45;stock --><g id="edge6" class="edge"><title>product&#45;&#45;stock</title><path fill="none" stroke="blue" d="M326.62,-172C345.3,-172 366.55,-172 383.85,-172"/><text text-anchor="middle" x="355.25" y="-178.8" font-family="Times,serif" font-size="14.00" fill="blue">gRPC</text></g><!-- stock&#45;&#45;db1 --><g id="edge11" class="edge"><title>stock&#45;&#45;db1</title><path fill="none" stroke="darkmagenta" d="M393.05,-153.79C365.17,-134.44 323.11,-104.8 317,-98"/><text text-anchor="middle" x="385.5" y="-124.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">DB</text><text text-anchor="middle" x="385.5" y="-109.8" font-family="Times,serif" font-size="14.00" fill="darkmagenta">(Pool)</text></g><!-- runonce --><g id="node10" class="node"><title>runonce</title><polygon fill="white" stroke="black" points="565.5,-190 474.5,-190 470.5,-186 470.5,-154 561.5,-154 565.5,-158 565.5,-190"/><polyline fill="none" stroke="black" points="561.5,-186 470.5,-186 "/><polyline fill="none" stroke="black" points="561.5,-186 561.5,-154 "/><polyline fill="none" stroke="black" points="561.5,-186 565.5,-190 "/><text text-anchor="middle" x="518" y="-168.3" font-family="Times,serif" font-size="14.00">RUNONCE</text></g><!-- runonce&#45;&#45;db1 --><g id="edge12" class="edge"><title>runonce&#45;&#45;db1</title><path fill="none" stroke="magenta" d="M496.3,-153.82C475.47,-138.37 442.47,-116.54 410,-106 390.27,-99.6 334.48,-109.17 317,-98"/><text text-anchor="middle" x="497" y="-124.8" font-family="Times,serif" font-size="14.00" fill="magenta">DB</text><text text-anchor="middle" x="497" y="-109.8" font-family="Times,serif" font-size="14.00" fill="magenta">(Avulsa)</text></g></g></svg></div>
<h2 id="bibliotecas"><a class="header" href="#bibliotecas">Bibliotecas</a></h2>
<p>As bibliotecas planejadas para o sistema são:</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-rpc</code>: Implementação de protocolos gRPC e de mensagens destes
protocolo. Deve ser importado em todos os módulos, sendo essencial para
a criação de clientes e servidores gRPC. Os modelos de comunicação
implementados para si devem ser também convertidos para e
a partir dos DTOs do módulo de dados.</li>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-data</code>: Implementação de utilitários de comunicação com banco de
dados (PostgreSQL) e objetos de transferência de dados (DTOs). Deve ser
importado em todos os módulos, exceto na comunicação REST. Os DTOs também
devem implementar traits e utilitários para conversão das mensagens
implementadas em <code>minerva-rpc</code> para os DTOs desta biblioteca.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-cache</code>: Implementação de utilitários de comunicação com
cache, message brokers e armazenamento temporário <em>in-memory</em> (Redis).
Deve ser importado principalmente no módulo de sessão.</li>
</ul>
<h2 id="módulos"><a class="header" href="#módulos">Módulos</a></h2>
<p>Os módulos planejados para o sistema são:</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-user</code>: Servidor gRPC para CRUD de usuários. Deve ser capaz de
manipular as regras de negócios relacionadas a clientes.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-session</code>: Servidor gRPC para gerência de sessão de usuário.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-product</code>: Servidor gRPC para CRUD de produtos. Deve ser capaz
de manipular as regras de negócios relacionadas a produtos, mas que não
envolvam controle de estoque.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-stock</code>: Servidor gRPC para CRUD de estoque de produtos. Deve
ser capaz de manipular as regras de negócios relacionadas a estoque, mas
que não envolvam manipulação de produtos.</li>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-rest</code>: Servidor REST para comunicação com os demais módulos
executáveis. Possui rotas que apontam para serviços específicos, e é por
definição um cliente gRPC de todos os servidores gRPC.</li>
<li><input disabled="" type="checkbox" checked=""/>
<code>minerva-runonce</code>: Serviço <strong>avulso</strong> para configuração do ambiente, de
forma assíncrona. Responsável pela execução de migrações do banco de dados
e outras operações de configuração inicial.</li>
<li><input disabled="" type="checkbox"/>
<code>minerva-report</code>: Servidor gRPC para geração de relatórios. Deve receber
dados com formatação esperada de um relatório, e então deverá gerar um
arquivo PDF e retorná-lo inteiramente como resposta.</li>
</ul>
<h2 id="portas"><a class="header" href="#portas">Portas</a></h2>
<p>Os serviços, independente de serem gRPC ou REST, devem ser executados em
certas portas padrão para evitarem conflitos durante o tempo de depuração.
Cada porta deve também ser configurável através de variáveis de ambiente.</p>
<p>A tabela a seguir discrimina as variáveis de ambiente e as portas padrão
de acordo com o serviço em questão.</p>
<table><thead><tr><th>Serviço</th><th>Variável</th><th>Valor</th></tr></thead><tbody>
<tr><td>USER</td><td><code>USER_SERVICE_PORT</code></td><td>9010</td></tr>
<tr><td>SESSION</td><td><code>SESSION_SERVICE_PORT</code></td><td>9011</td></tr>
<tr><td>PRODUCT</td><td><code>PRODUCT_SERVICE_PORT</code></td><td>9012</td></tr>
<tr><td>STOCK</td><td><code>STOCK_SERVICE_PORT</code></td><td>9013</td></tr>
<tr><td>REPORT</td><td><code>REPORT_SERVICE_PORT</code></td><td>9014</td></tr>
<tr><td>REST</td><td><code>ROCKET_PORT</code></td><td>9000</td></tr>
</tbody></table>
<p>No caso do serviço REST, verifique o arquivo <code>Rocket.toml</code> para avaliar
a configuração em desenvolvimento e em produção do mesmo.</p>
<h2 id="gateways"><a class="header" href="#gateways">Gateways</a></h2>
<p>Os serviços também podem operar em máquinas diferentes, dependendo de sua
rota.</p>
<p>Normalmente, quando todos os serviços são executados manualmente na mesma
máquina, operamos com uma rota <code>localhost</code>. Nesse caso, a variável de
ambiente de cada serviço é definida como esse valor.</p>
<p>Todavia, num ambiente de orquestração de contêineres (como Docker Compose
ou Kubernetes), cada serviço estará operando de forma separada, e poderá
comunicar-se com os outros serviços por intermédio de uma rede interna
ao qual apenas os serviços têm acesso de forma explícita. Assim, as
variáveis de ambiente que determinam o nome do servidor devem ser definidas
manualmente, de acordo com a forma como o deploy de cada serviço foi
realizado.</p>
<p>A seguir, temos uma tabela relacionando variáveis de ambiente com seus
devidos valores, que serão resolvidos através do DNS da rede interna criada
pelo orquestrador de contêineres.</p>
<p>No caso do serviço REST, verifique o arquivo <code>Rocket.toml</code> para avaliar
a configuração em desenvolvimento e em produção do mesmo.</p>
<table><thead><tr><th>Serviço</th><th>Variável</th><th>Valor em Produção</th></tr></thead><tbody>
<tr><td>USER</td><td><code>USER_SERVICE_SERVER</code></td><td><code>users</code></td></tr>
<tr><td>Banco de Dados</td><td><code>DATABASE_SERVICE_SERVER</code></td><td><code>postgresql</code></td></tr>
<tr><td>REST</td><td>nenhuma</td><td><code>rest</code></td></tr>
<tr><td>RUNONCE</td><td>nenhuma</td><td><code>runonce</code></td></tr>
</tbody></table>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="estrutura.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="multi-tenancy.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="estrutura.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="multi-tenancy.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
